---
layout: post
title: ubuntu 24.04 server serial install
tags: 24.04
permalink: /pages/ubuntu-24.04-server-install-serial.html
---

## Prepare
- get `ubuntu-24.04.3-live-server-amd64.iso`
:warning: isomaster renders the iso unbootable
- Open the iso using `isomaster`
   ```bash
   sudo apt-get install isomaster
   isomaster Downloads/remove/ubuntu-24.04.3-live-server-amd64.iso
   ```
- edit `/boot/grub/grub.cfg`
   - add `console=tty0 console=ttyS0,115200n8` on the "linux" lines, before `---`
      ```properties
      ...
      menuentry "Try or Install Ubuntu Server" {
        set gfxpayload=keep
        linux   /casper/vmlinuz console=tty0 console=ttyS0,115200n8 ---
        initrd  /casper/initrd
    }
    menuentry "Ubuntu Server with the HWE kernel" {
            set gfxpayload=keep
            linux   /casper/hwe-vmlinuz console=tty0 console=ttyS0,115200n8 ---
            initrd  /casper/hwe-initrd
    }
   ...
   - enable grub serial ouptput
      ```properties
      set timeout=30
      serial --unit=0 --speed=9600
      terminal_input serial; terminal_output serial
      ...
      ```
- save as `ubuntu-24.04.3-live-server-amd64-ttyS0.iso`

```
ipmitool -I lanplus -H 10.13.2.10 -U serial_u -P serial_p sol set volatile-bit-rate 115.2
ipmitool -I lanplus -H 10.13.2.10 -U serial_u -P serial_p chassis bootdev bios
ipmitool -I lanplus -H 10.13.2.10 -U serial_u -P serial_p power reset
ipmitool -I lanplus -H 10.13.2.10 -U serial_u -P serial_p sol activate

┌────────────────────────────────────┐                               
│     Please select boot device:     │                               
│────────────────────────────────────│                               
│ UEFI: Samsung Flash Drive FIT 1100 │                               
> UEFI: SanDisk Extreme Pro 0        <                               
│ Enter Setup                        │                               
│────────────────────────────────────│                               
│     ↑ and ↓ to move selection      │                               
│    ENTER to select boot device     │                               
│     ESC to boot using defaults     │                               
└────────────────────────────────────┘

```

Do that, in that order packages **in order**

* sudo apt-get update
* install etckeeper
* disable swap
* sudo apt-get dist-upgrade
* fwupdate then disable automatic
* sudo apt-get install aptitude htop ncdu lm-sensors quota quotatool pwgen
* rescue user
* sudoers
* disable automatic update
  * /etc/apt/apt.conf.d/20auto-upgrades
  * dpkg-reconfigure unattended-upgrades
  * snap refresh --hold=forever
  * disable update-notifier
* backup
* ntp
* disable clear console on boot
* be quiet
* disable ModemManager
* enable quota
* bridge network
* libvirt-daemon-system bridge-utils
* docker
* locales
* certbot
* smartmontools
* monit
* journalctl
